<tool id="dada2biom" name="Convert DADA2 Output to BIOM." version="0.1.0">
    <requirements>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        dada2biom.R
		$asv 
		$taxa 
		$output
		#if $meta.opts:
			-m $meta.metadata
			-s $meta.samp_col 
			#if $meta.regex and $meta.regex is not None:
				-R $meta.regex
			#end if
		#end if
    ]]></command>
    <inputs>
        <param type="data" name="asv" label="ASV output from DADA2" format="tsv" />
        <param type="data" name="taxa" label="Taxa output from DADA2" format="tsv" />
		<conditional name="meta" >
			<param name="opts" type="boolean" label="Have metadata" />
			<when value="true">
				<param type="data" name="metadata" format="tsv" label="A TSV of metadata corasponding to the samples" />
				<param type="text" name="samp_col" label="Sample Name Column" help="Name or number of column in the metadata that uniquely matches part of the sample name used in the ASV" />
				<param type="text" name="regex" label="ASV name extraction regex." help="If left blank, the program will try to automaticlly match names based on substrings. Use this if it fails. Regex to exctract names form ASV sample names and match them exactly to to metadata samp_col. Double escapes \\w" optional="true" />
			</when>
			<when value="false">
			</when>
		</conditional>
    </inputs>
	<outputs>
		<data name="output" format="json" />
    </outputs>
    <help><![CDATA[
       usage: /home/christian/lab//genelab/dada2_cli/cli/dada2biom.R
       [-h] [-m METADATA] [-s SAMP_COL] asv_table taxa_table output

	positional arguments:
	  asv_table             Name of (or path to) the ASV table output from DADA2.
	                        In R matrix format. aka first feild of col names is
        	                missing
	  taxa_table            Name of (or path to) the taxa table file from
	                        assign_tax
	  output                Name of (or path to) the output BIOM file.
	
	optional arguments:
	  -h, --help            show this help message and exit
	  -m METADATA, --metadata METADATA
	                        Name of (or path to) the metadata, samples as rows
	  -s SAMP_COL, --samp_col SAMP_COL
        	                Name or number of column in the metadata that uniquely
                	        matches part of the sample name used in the ASV
    ]]></help>
    <citations>
        <citation type="bibtex">
@misc{githubGeneLab_DADA2_Paired_Pipeline,
  author = {Erikson, Christian},
  year = {2018},
  title = {GeneLab_DADA2_Paired_Pipeline},
  publisher = {GitHub},
  journal = {GitHub repository},
  url = {https://github.com/cErikson/GeneLab_DADA2_Paired_Pipeline},
}</citation>
    </citations>
</tool>
